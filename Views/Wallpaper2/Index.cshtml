@model IEnumerable<TimeTask.Models.Wallpaper2>

@{
    ViewData["Title"] = "Index";
}

<link rel="stylesheet" href="~/css/site_form.css" asp-append-version="true" />

<div class="parent">
    <section class="left-nav">
        @*<partial name="_Settings" />*@

        <div class="IdRKPExyAQSewBL">
            <a class="settings_a" href="@Url.Action("Index", "MainSettings")">
                @* <svg viewBox="-8.5 0 32 32" width="32" height="32"><path d="M15.281 7.188v17.594l-15.281-8.781z"></path></svg> *@
                <ion-icon name="arrow-back-outline"></ion-icon>
                <span>Wróć</span>
            </a>
        </div>
        <div class="user">
            <a class="settings_a" asp-area="Identity" asp-page="/Account/Manage/Index">
                <ion-icon name="person-outline"></ion-icon>
                <div class="OxavFctgPAvYCMk">
                    <span>@User.Identity?.Name?.Split('@')[0]</span>
                    <span>Ustawienia konta</span>
                </div>
            </a>

            @* <a asp-area="Identity" asp-page="/Account/Manage/Index" class="userFirstA">
                <svg viewBox="0 0 512 512" width="48" height="48">
                    <path d="M213.333333,3.55271368e-14 C269.912851,3.55271368e-14 324.175019,22.4761259 364.18278,62.4838867 C404.190541,102.491647 426.666667,156.753816 426.666667,213.333333 C426.666667,331.15408 331.15408,426.666667 213.333333,426.666667 C95.5125867,426.666667 2.84217094e-14,331.15408 2.84217094e-14,213.333333 C2.84217094e-14,95.5125867 95.5125867,3.55271368e-14 213.333333,3.55271368e-14 Z M234.666667,234.666667 L192,234.666667 C139.18529,234.666667 93.8415802,266.653822 74.285337,312.314895 C105.229171,355.70638 155.977088,384 213.333333,384 C270.689579,384 321.437496,355.70638 352.381644,312.31198 C332.825087,266.653822 287.481377,234.666667 234.666667,234.666667 L234.666667,234.666667 Z M213.333333,64 C177.987109,64 149.333333,92.653776 149.333333,128 C149.333333,163.346224 177.987109,192 213.333333,192 C248.679557,192 277.333333,163.346224 277.333333,128 C277.333333,92.653776 248.679557,64 213.333333,64 Z"></path>
                </svg>
            </a>
            <div class="userDiv">
                <a>@User.Identity?.Name?.Split('@')[0]</a>
            </div>
            <form class="logOut" asp-area="Identity" asp-page="/Account/Logout" asp-route-returnUrl="@Url.Action("Index", "Home", new { area = "" })">
                <input type="submit" value="" id="logOutClick" />
                <button type="button" title="Wyloguj" onclick="logOut()">
                    <svg viewBox="-2 0 19 19" width="37" height="37">
                        <path d="M7.498 17.1a7.128 7.128 0 0 1-.98-.068 7.455 7.455 0 0 1-1.795-.483 7.26 7.26 0 0 1-3.028-2.332A7.188 7.188 0 0 1 .73 12.52a7.304 7.304 0 0 1 .972-7.128 7.221 7.221 0 0 1 1.387-1.385 1.03 1.03 0 0 1 1.247 1.638 5.176 5.176 0 0 0-.993.989 5.313 5.313 0 0 0-.678 1.181 5.23 5.23 0 0 0-.348 1.292 5.22 5.22 0 0 0 .326 2.653 5.139 5.139 0 0 0 .69 1.212 5.205 5.205 0 0 0 .992.996 5.257 5.257 0 0 0 1.178.677 5.37 5.37 0 0 0 1.297.35 5.075 5.075 0 0 0 1.332.008 5.406 5.406 0 0 0 1.32-.343 5.289 5.289 0 0 0 2.211-1.682 5.18 5.18 0 0 0 1.02-2.465 5.2 5.2 0 0 0 .01-1.336 5.315 5.315 0 0 0-.343-1.318 5.195 5.195 0 0 0-.695-1.222 5.134 5.134 0 0 0-.987-.989 1.03 1.03 0 1 1 1.24-1.643 7.186 7.186 0 0 1 1.384 1.386 7.259 7.259 0 0 1 .97 1.706 7.413 7.413 0 0 1 .473 1.827 7.296 7.296 0 0 1-4.522 7.65 7.476 7.476 0 0 1-1.825.471 7.203 7.203 0 0 1-.89.056zM7.5 9.613a1.03 1.03 0 0 1-1.03-1.029V2.522a1.03 1.03 0 0 1 2.06 0v6.062a1.03 1.03 0 0 1-1.03 1.03z"></path>
                    </svg>
                </button>
            </form> *@
        </div>

    </section>
    <section class="right-nav">
        <div class="DhOaDlrUqJcgIUx">
            <form class="bSaEpYjaUnwwExg">

                <div class="vYNssMDjXkiqBLO">
                    <label id="jcCdkRVXykGrbBe" style="display: none;">Invalid link!</label>
                </div>

                <div class="form-floating mb-2 CvFOfCxRqEKEFvM">
                    <input class="form-control zyMjnkiLNtYlAAW" id="xoMTaiKaxAoinee" placeholder="Paste link to wallpaper here." />
                    <label class="form-label" id="GTyCoJidzRasoFw">Add wallpaper by putting link here...</label>
                    @*<input type="file" id="XcnokWtReFwvSRs">*@
                </div>
                <input type="button" id="ZPHuxBbGXtBuQTe" class="btn-custom" value="Add" />
            </form>
        </div>


        @if (Model.Count() != 0)
        {
            <div class="DhOaDlrUqJcgIUx">
                <form class="bSaEpYjaUnwwExg">
                    <div class="TklztUXRygbrLDz">

                        <label>
                            <input type="radio" name="same" id="defaultWallpaper" onchange="changeWallpaper(this)">
                            <span>Default</span>
                            <img src="~/css/img/backgrounds/the-illustration-graphic-consists-of-abstract-background-with-a-blue-gradient-dynamic-shapes-composition-eps10-perfect-for-presentation-background-website-landing-page-wallpaper-vector.jpg" class="uPITXoaTMJUxLzR" />
                        </label>

                        @{ int i = 1; }
                        @foreach (var item in Model.OrderBy(x => x.Id))
                        {
                            <label>
                                <input type="radio" name="same" id="customWallpaper_@i" onchange="changeWallpaper(this)">
                                <span>#@i</span>
                                <img src="@item.Link" class="uPITXoaTMJUxLzR" />
                                <a onclick="MVyuHPTvDFWSLCA(this, event)" id="sbkudnsgkdEqpwD" omdBELCmLLFmdFy="@item.Id">
                                    <span>Delete</span>
                                </a>
                            </label>

                            i++;
                        }
                    </div>
                </form>
            </div>
        }
        else
        {
            <div class="DhOaDlrUqJcgIUx">
                <form class="bSaEpYjaUnwwExg">
                    <div class="TklztUXRygbrLDz">
                        <label>
                            <input type="radio" name="same" id="defaultWallpaper" onchange="changeWallpaper(this)" checked>
                            <span>Default</span>
                            <img src="~/css/img/backgrounds/the-illustration-graphic-consists-of-abstract-background-with-a-blue-gradient-dynamic-shapes-composition-eps10-perfect-for-presentation-background-website-landing-page-wallpaper-vector.jpg" class="uPITXoaTMJUxLzR cOAjaWuJVPBGngI" />
                        </label>
                    </div>
                </form>
            </div>
        }
    </section>

</div>

<script type="text/javascript" src="~/js/site.js"></script>

<script type="text/javascript">

    //$('#XcnokWtReFwvSRs').on('change', function(e){
    //    //xoMTaiKaxAoinee
    //    if (e.target.files[0])
    //    {
    //        document.getElementById('xoMTaiKaxAoinee').value = e.target.files[0];
    //    }
    //});

    function MVyuHPTvDFWSLCA(t, e){
        e.preventDefault();

        let id_ = t.getAttribute('omdBELCmLLFmdFy');

        $.ajax({
            type: 'POST',
            url: '/Wallpaper2/RemoveWallpaper',
            data: {
                id: id_
            },
            success: function (response)
            {
                //localStorage.removeItem('wallpaper');
                if ($(t).parent().children().eq(2).attr('src') == localStorage.getItem('wallpaper'))
                {
                    localStorage.removeItem('wallpaper');
                }
                location.reload();
            },
            error: function (xhr, status, error)
            {
                console.log('Error adding data:', error);
            }
        });
    };


    let defaultWallpaper = localStorage.getItem('wallpaper');
    if(defaultWallpaper != null){
        $('html').css({
            'background': 'url(' + defaultWallpaper + ')',
            'background-size': 'cover',
            'background-position': 'center'
        });

        let w = document.querySelectorAll('.uPITXoaTMJUxLzR');
        for (let i = 0; i < w.length; i++)
        {
            if ($(w[i]).attr('src') == defaultWallpaper)
            {
                $(w[i]).parent().children().eq(0).prop("checked", true);
                $(w[i]).addClass('cOAjaWuJVPBGngI');
            }
        }
    }
    else {
        $('#defaultWallpaper').prop("checked", true);
        $('#defaultWallpaper').parent().children().eq(2).addClass('cOAjaWuJVPBGngI');
    }

    function changeWallpaper(t) {
        let w = document.querySelectorAll('.uPITXoaTMJUxLzR');
        for(let i = 0; i < w.length; i++){
            $(w[i]).removeClass('cOAjaWuJVPBGngI');
        }

        $(t).parent().children().eq(2).addClass('cOAjaWuJVPBGngI');


        localStorage.setItem('wallpaper', $(t).parent().children().eq(2).attr('src'));
        $('html').css({
            'background': 'url(' + $(t).parent().children().eq(2).attr('src') + ')',
            'background-size': 'cover',
            'background-position': 'center'
        });
    };




    //let selected = document.getElementById('RulQCOUeIjlrFpq');
    //selected.classList.add('settings_a_selected');

    function isValidHttpUrl(string)
    {
        let url;

        try
        {
            url = new URL(string);
        } catch (_)
        {
            return false;
        }

        return url.protocol === "http:" || url.protocol === "https:";
    }

    function checkURL(url)
    {
        return (url.match(/\.(jpeg|jpg|gif|png)$/) != null);
    }

    $('#ZPHuxBbGXtBuQTe').on('click', function ()
    {
        if (document.getElementById('xoMTaiKaxAoinee').value.length > 0) //&& isValidHttpUrl(document.getElementById('xoMTaiKaxAoinee').value) && checkURL(document.getElementById('xoMTaiKaxAoinee').value)
        {
            $.ajax({
                type: 'POST',
                url: '/Wallpaper2/AddWallpaper',
                data: {
                    link: document.getElementById('xoMTaiKaxAoinee').value,
                    chosen: false
                },
                success: function (response)
                {
                    location.reload();
                },
                error: function (xhr, status, error)
                {
                    console.log('Error adding data:', error);
                }
            });
        }
        else if (document.getElementById('xoMTaiKaxAoinee').value.length > 0 && !isValidHttpUrl(document.getElementById('xoMTaiKaxAoinee').value))
        {
            $('#xoMTaiKaxAoinee').addClass('SHnDWPzuoAGGIwU');
            $('#jcCdkRVXykGrbBe').show();
        }
        else if (document.getElementById('xoMTaiKaxAoinee').value.length == 0)
        {
            $('#xoMTaiKaxAoinee').addClass('SHnDWPzuoAGGIwU');
            $('#jcCdkRVXykGrbBe').show();
        }
        else {
            $('#xoMTaiKaxAoinee').addClass('SHnDWPzuoAGGIwU');
            $('#jcCdkRVXykGrbBe').show();
        }
    });

    $('#xoMTaiKaxAoinee').on('keyup', function ()
    {
        if (this.value == 0)
        {
            $('#xoMTaiKaxAoinee').removeClass('SHnDWPzuoAGGIwU');
            $('#jcCdkRVXykGrbBe').hide();
        }
    });




</script>

